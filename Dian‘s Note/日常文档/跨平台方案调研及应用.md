跨平台方案调研及应用

> 🤔 如果变成了微信，如果接入第三方开发者来开发 酷皮小程序

# 一、背景介绍

> 随着前段技术的发展，跨平台方案越来越的成熟。目前公司一直为原生开发，导致部分较简单的压面需要双端开发。本次选型宗旨：简单的界面尽量减少双端开发，利用跨平台方案开发节省时间及人力的成本，并做到双端统一。

1. ## 方案选型

目前流行的跨端方案有三种：

1. H5+原生(微信小程序、Cordova、Ionic)
2. js+原生(React Native、Weex)
3. 自绘UI+原生(Flutter、QT)

| **技术类型(框架)**                      | **效率** | **性能** | **动态化** | **渲染方式** |
| --------------------------------------- | -------- | -------- | ---------- | ------------ |
| **H5+原生(微信小程序、Cordova、Ionic)** | 高       | 一般     | 支持       | WebView      |
| **js+原生(React Native、Weex)**         | 中       | 较好     | 支持       | 原生控件     |
| **自绘UI+原生(Flutter、QT)**            | 高       | 较好     | 默认不支持 | 系统API      |

1. ## 优缺点分析

### H5+原生(微信小程序、Cordova、Ionic) - Hybrid

​        cordova是最早一批跨平台解决方案之一，是当时最热门的跨平台解决方案。目前可选用Ionic框架开发，他可以轻松的使用web技术构建高质量的跨平台移动应用，俗称: Hybrid App

优点：

1. Ionic看起来已经和大部分原生一样了
2. cordova丰富d的衔接Navtive平台插件。
3. Ionic开发成本低 一套代码吃Android、iOS、web、小程序。

缺点：

1. 对于复杂界面或动画体验不好
2. 基于webView渲染体验较原生相比较差，目前有改进。

### js+原生(React Native、Weex)

React Native (简称RN) facebook于2015年4月开源的移动应用跨平台框架，使用javascript语言，

Wexx 2015年alibaba推出的一款跨平台框架 ，集成WeexSDK之后使用javaScript语言。

优点：

1. web开发技术栈，上手快成本低
2. 相比原生开发速度快，相比性能比Hybrid好
3. 原生渲染。动态，支持热更

缺点：

1. 渲染时需要js原生频繁调用而产生卡顿
2. 原生渲染固不同平台的空间需要单独维护， 维护成本较高。

### 自绘UI+原生(Flutter、QT)

Flutter是谷歌推出的一个全新的高性能高一致性的跨平台的开发框架。

优点： 

1. 使用Dart语言一套代码即可开发  Dart语法很像JS+Java+Swift+Kotlin+C#+TypeScript+JS+PHP 上手成本较低。
2. skia渲染引擎,性能高。
3. 丰富的社区支持开源多，丰富的组件支持扩展性强

缺点：

1. 不够灵活，不能像Hybrid动态下发
2. web层面有些欠缺
3. 框架较重成本较高，不如 webView来的快和灵活。



1. ## 总结

公司内部需求为复杂的需求原生做，简单的需求跨端做。

跨端做的一些需求大多是一些简单的页面开发性能方面WebView渲染方式足够支撑业务需求。***

动态化三种方式都可行、效率上择优选择。

综上所述 最终决定使用H5+原生(微信小程序、Cordova、Ionic)-Hybrid 方案作为本次跨平台方案的首选方案

# 二、项目目标

> 思考 ：如果我们变成了微信，如果接入第三方开发者来开发 酷皮小程序

# 三、月度里程碑

> [Capacitor-Vue 跨平台项目计划与执行](https://cyzj3pgpi6.feishu.cn/docs/doccnYqIRxEr24iGeAO8LmEnm5f) 

# 四、任务拆解

> [Capacitor-Vue 跨平台项目计划与执行](https://cyzj3pgpi6.feishu.cn/docs/doccnYqIRxEr24iGeAO8LmEnm5f) 

# 五、基础知识介绍

## Hybrid App

Hybrid App 为HTML5+原生进行混合开发的App。主要使用js和原生相互调用即可以初步实现跨平台的使用效果。

- Native App 架构图
- Hybrid App 架构图

1. ### **[Cordova](https://cordova.apache.org/docs/en/10.x/guide/platforms/ios/index.html)**  

​        [Cordova](https://cordova.apache.org/docs/en/10.x/guide/platforms/ios/index.html)是很早期的跨平台解决方案，它是从更早期的PhoneGap分支出来的。在我刚开始接触跨平台开发的那个年代（大概2012年），它是最热门的跨平台解决方案。为什么呢？因为它简单好上手，而且那时候它的对手是Xamarin跟Titanium，两者都是要付费的（这两个后面会作介绍

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=NzA4NzBkN2MyODk2NjFhZmY4ZmQ4NDVlMzliYzFmYmFfcmVFSjdwTVpVVXFON1NFSG5xV0FobGdtOTFHa09CMk9fVG9rZW46Ym94Y25QYnUwWTVlQkpFNUFOZ3Q5UGRncHlmXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

图片来源：Cordova 官网 



**[Cordova Application](https://cordova.apache.org/docs/en/10.x/guide/platforms/ios/index.html)**是**Cordova**框架独立于不同手机操作系统的一个封装层。具体包括

1. Web App层是开发人员编写代码的主要地方，应用程序以网页的形式呈现，在一个index.html的本地页面文件中引用所需要的各种Web资源，如CSS、JavaScript、图像、影音文件等。应用程序的配置保存在config.xml文件中。
2. WebView层用来呈现用户界面，即web页面的展现。例如，iOS通过WKwebView控件实现呈现，Android平台是通过WebView控件实现web页面的呈现。
3. Plugins主要用于在JavaScript代码中调用各平台native的功能。Cordova项目已经包含一些核心的plugin，如电池、摄像头、通讯录等。开发人员也可以开发自定义的plugin，来实现所需要的功能。



**Mobile OS**是具体的手机操作系统层了，Cordova目前支持大部分的手机OS：iOS、Android、windowsphone等等；

实际上我们可以这么理解所谓的“跨平台”：

Cordova预先帮我们预先封装了各种mobile os上最常用的本地api调用，然后以统一的JavaScript api形式提供给webapp开发者调用。对于开发者来说，不需要关注系统底层调用实现细节，也就实现了所谓的“跨平台”。实际上，各平台涉及到本地能力的调用的时候，都被封装成了各种插件。

1. ### [Capacitor](https://capacitorjs.com)

​     Capacitor 是用于构建 Web Native 应用程序的开源框架。使用 JavaScript、HTML 和 CSS 创建跨平台的 iOS、Android 和 CSS Web 应用程序。

​     Capacitor由Ionic Framework团队设计，作为**Cordova**的最终替代品，向后兼容Cordova插件，它可以在没有Ionic Framework的情况下使用，但很快它将成为Ionic开发者体验的核心部分。

1. ### [Ionic](https://ionicframework.com/docs)

Ionic 是一个开源 UI 工具包，用于使用 Web 技术（Vue、HTML、CSS 和 JavaScript）构建高性能、高质量的移动和桌面应用程序，并集成了[Angular](https://ionicframework.com/docs/angular/overview)、[React](https://ionicframework.com/docs/react)和[Vue](https://ionicframework.com/docs/vue/overview)等流行框架。

1. ### [Ionic-Portals](https://ionic.io/docs/portals)

​     嵌入式 Web 应用的移动项目。

​     Ionic Portals 建立在[Capacitor](https://capacitorjs.com/)混合应用程序运行时之上

Ionic Portals 是适用于 iOS 和 Android 的增强型原生 WebView 组件，可让您将基于 Web 的体验添加到原生移动应用程序中。使原生和 Web 能够更好地协作，并以安全、可控的方式为移动设备带来新的体验。

1. ### PWA

 Progressive Web App  渐进式 Web APP  增强webView

通过各种 Web 技术实现与原生 App 相近的用户体验。



# 六、开发指南

1. ## Cordova开发指南 （参考用，项目使用Capacitor构建）

   1. **Cordova安装**
      1. 使用**nmp** 安装 **cordova  若没有安装nmp请跳转****[Mac 下安装 npm](https://www.jianshu.com/p/f6c6e73ea198)**
      2. 安装cordova

MacOS:

```
sudo npm install -g cordova
```

如果出现"xxx/permission denyed"的错误,可以在`npm`命令前加`sudo`前缀.

Window:

```
C:\>npm install -g cordova
```

命令中`-g`标志告诉`npm`全局安装`cordova`. 否则, 它将安装在当前工作目录的`node_modules`子目录中.

1. **创建一个工程**
   1. **使用CLI命令创建，cd到Cordova项目目录下**。

```
cordova create <项目名> <包名> HelloWorld
```

这将为你的cordova 应用程序创建所需的目录结构。默认情况下，该`cordova create`脚本会生成一个基于 Web 的框架应用程序，其主页是项目的`www/index.html`文件。

[Cordova 创建命令参考文档](https://cordova.apache.org/docs/en/10.x/reference/cordova-cli/index.html#cordova-create-command)

[Cordova 项目目录结构](https://cordova.apache.org/docs/en/10.x/reference/cordova-cli/index.html#directory-structure)

[Cordova 项目模板](https://cordova.apache.org/docs/en/10.x/guide/cli/template.html#)

打开Mac终端输入上面的命令, 创建一个Cordova项目, 得到项目目录结构如下:

1. **添加平台**

下面的这些命令必须在上面创建项目的目录下运行, 或者子目录也行

```
cd 项目名
```

添加你App定位的平台. 我们将添加'ios'和'android'平台并确保它们保存到config.xml和package.json:

iOS平台

```
cordova platform add ios
```

Android平台

```
cordova platform add android
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=NmU4YWZjMTkyOGNmZDRmM2Q4OTUyYjg4YWNiYzdmYjVfUUVGZ3ZuVmt2SHA4enMyOXZGc0RVSmFhUWp0V1VCUjJfVG9rZW46Ym94Y241d2ZoRWdBWktUMWptZmYwTjIwdmJjXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

查看所添加的平台

```
cordova platform ls
```

运行添加或删除平台的命令会影响项目*平台*目录的内容，其中每个指定的平台都显示为一个子目录。

[Cordova 平台命令参考文档](https://cordova.apache.org/docs/en/10.x/reference/cordova-cli/index.html#cordova-platform-command)

1. **安装构建的先决条件**

```
cordova requirements
```

要构建和运行应用程序，需要安装对应平台的SDK。或使用浏览器进行开发，则可以使用`browser`不需要任何平台 SDK 的平台。

[安卓平台要求](https://cordova.apache.org/docs/en/10.x/guide/platforms/android/index.html#requirements-and-support)

[iOS平台要求](https://cordova.apache.org/docs/en/10.x/guide/platforms/ios/index.html#requirements-and-support)

[Windows 平台要求](https://cordova.apache.org/docs/en/10.x/guide/platforms/windows/index.html#requirements-and-support)

1. **构建应用程序**

运行次命令为所有平台构建项目：

```
cordova build
```

运行次命令为所有平台构建项目：

```
cordova build ios
cordova build android
```

[Cordova 构建命令参考文档](https://cordova.apache.org/docs/en/10.x/reference/cordova-cli/index.html#cordova-build-command)

1. **测试**

可以打开对应的编译器进行启动。

或者

```
cordova run ios
cordova run android
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGE1MzNiOGQ4YzFhNjllM2Y5OGIxZWM0OTZmYTA5MDBfNEhEbXNndUpQOXNtWFZIcFVVSnJiYURadlRFckpsQWZfVG9rZW46Ym94Y25zcGFNZ0ZXYXBlUmJZZmVwT0hrdXBkXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

[设置安卓模拟器](https://cordova.apache.org/docs/en/10.x/guide/platforms/android/index.html#setting-up-an-emulator)

[Cordova 运行命令参考文档](https://cordova.apache.org/docs/en/10.x/reference/cordova-cli/index.html#cordova-run-command)

[Cordova 模拟命令参考文档](https://cordova.apache.org/docs/en/10.x/reference/cordova-cli/index.html#cordova-emulate-command)

1. **添加插件**

插件是指能够使Cordova WebView和相应原生平台就行交互的注入代码包. 插件给基于Web的App提供对原生设备和平台功能的访问.

 本质上是一个js文件+原生类(比如Android的Java类,iOS的OC/Swift类), JavaScript接口供前端调用,这影藏了背后的各种native代码的实现.

插件添加可以通过插件id和Git repo的url来添加:

通过id来添加

```
cordova plugin search camera
```

通过Git repo来添加

```
cordova plugin add https://github***
```

查看安装的plugin

```
cordova plugin ls
```

[Cordova-CLI参考](https://cordova.apache.org/docs/en/latest/reference/cordova-cli/index.html)

1. **升级Cordova和项目**

1. ## 原生平台混合Cordova开发

https://www.jianshu.com/p/e882d87d1e70



1. ## Capacitor开发指南

 Capacitor前段环境准备

**安装 Vue CLI v3**

```
npm install -g @vue/cli
```

生成一个新的 Vue 项目

### **创建Vue项目**

```
yarn create vite
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=NTRmMmE5NzNhZGY1N2E3MGZmN2MyZmU1Y2JkN2I5MjFfQ2I1SkhuT3hPd1lzemFrazRxdlBIeHFnRkgydWV0TmVfVG9rZW46Ym94Y25rSzJORnhtWWRlR1RkWTVnQTZMd0RiXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

**安装依赖：**

```
cd .\v3-native-demo\ &`` ``yarn
```

**进入项目目录**

```
cd CPWebBridgeView
```

### **添加Capacitor环境**

**安装core模块**

```
npm i @capacitor/core
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=M2E0OTU0MWRiNjRlNzkyN2RhMWE4OThlNTUzMGQ4NjhfSnRzYUdQcVQwUGU5eVRwYmdhWmR2ZmhWbHlUeHpLbDRfVG9rZW46Ym94Y25ENG9lOFNTRXE4ems3YzJYQnc0MlZnXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

安装成功后会在webApp目录下新增node_modules

**安装脚手架**

```
npm i @capacitor/cli
```

**初始化项目**

```
npx cap init <项目名> <包名> --web-dir=dist
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWFlNTAxMmM2YjA5MWM0MTU1OWY1N2NmYTk0Mjg2MzBfNXBiNFBoc21IVkcyZGpTRXJNVjg2WGh2VGZpQVRKT1lfVG9rZW46Ym94Y25kVWVNTXhQeXgwaTkwQ3Z5TVF2eUVnXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

**添加支持的平台**

**安装安卓环境依赖：**

```
npm install @capacitor/android
npm install @capacitor/ios
```

 **添加安卓环境到项目：**

```
npx cap add android
npx cap add ios
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=MmE2YzkyOTY4NGY4N2ZhOTk5OWNmZGFiYTlmM2U2Y2FfUGNOR0N3Z2xINFRmMUxIWEZGT3hiVjk5TEJ1c1Ezc01fVG9rZW46Ym94Y252QUl6dTFTVVdYRWRyYWFzdVpaOTRmXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

添加完成后 工程名目录中会出现两个平台的对应的项目目录

**查看项目创建结果**

```
yarn run dev 
```

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmVkNzUyZDdjNjRhYjBiNGIwZWJmZTNmODAwYzcyNTBfelk3Uk1Hd3JoMmtaSGlZeERka2czTzdFTEZaR3kwcDlfVG9rZW46Ym94Y25CcmNzbGUzT2lkMTliZHhOeFhncnU4XzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

访问 local中的地址  即为你当前本地的地址  可在web中查看vue项目的初始化界面

**同步资源至双平台**

```
yarn cap sync
```

**打开iOS项目**

```
yarn cap open ios
```



### **iOS构建**

**添加iOS依赖**

创建 CPWebBridgeViewController 集成自CAPBridgeViewController

创建 NavWebViewController 将rootViewController设置为CPWebBridgeViewController

```Swift
import UIKit

import Capacitor



/// 入口文件

class NavWebViewController: UINavigationController {

  init() {

    super.init(rootViewController: CPWebBridgeViewController())

  }

  required init?(coder aDecoder: NSCoder) {

    super.init(rootViewController: CPWebBridgeViewController())

    navigationBar.tintColor = UIColor.clear

    navigationBar.isHidden = true

  }

}



/// BridgeView

public class CPWebBridgeViewController: CAPBridgeViewController {

  public override func viewDidLoad() {

    super.viewDidLoad()

  }

}
```

将NavWebViewController设置为启动入口

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=MDBhOTM1MTlhYzU4ODAwNTE4ZjM5Yjg0MmI0OGU2OTBfOU1yNUVpTThDdjVqUDVUN2t6ZVA3TXR0dzVnRXVKVElfVG9rZW46Ym94Y25vRExRY2hmSmRiSnZCTEE5eG9ZMEhoXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

静态库创建为其他工程提供接口

iOS Deployment Target 设置为 iOS 12.0

Targetd Device Family 设置为 iPhone

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=YzhlM2E4MTYzMWUyYmNkZGEyODkyNjMzOTAzYzA3YjFfTnRFamhKY1dHOE1RUWJ6SnFyVTJ0RGIyUHJPTEtWVlNfVG9rZW46Ym94Y245dG9CcHpaUEY0U1NKQjFMM0s3Q3hkXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

在Podfile文件中加入静态库的target，重新pod install

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=YzM3NGU5NTgyY2Q2YzMzNmVkODcyZWU5ODllYmZmNDhfZDNaUTJBV0szYjd4amNLRTVFUzdGNWV1NEZoeW9VemNfVG9rZW46Ym94Y25sY093S0h2ajA3SFZlMVlvVTR5bWhBXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

选中项目中已有的类的文件，勾选上静态库的target

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=ODA1NmU2MDMzOWY4ZTlmYjJhZGEzZWUxMzMzZDBmYzVfZE80ZFVRamt5UnplbDZSTUlRSmZqR0RhdW5DUEhpVWVfVG9rZW46Ym94Y25HTk5DUkVaZERac0I1OTZ1MThRY3JiXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)



### 融合Capacitor-Vue至Native --  iOS 

**native项目左下角加号  add File**

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=MmIwMGIxZDdhZDc3NTA5OTJmNTA3M2Q4M2M5OGY4ZGZfQnM3ZDZSbFk5TDRTNzJRQ3ZFUzJBcmh2NWplSlVNWHJfVG9rZW46Ym94Y25oNG9sdjUyNnlGeWRWWkJUVGZmR2NnXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

**添加 Capacitor-Vue中的iOS项目的App.xcodeproj 文件**

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=MjM2YjFlY2NhOGUyOTg2NzgwNzk4OGFlNzU3YzY4MzJfcTE4aGE0OXZ5eENTUk9IVFVZVWlCeG44cUtJQ3V2eFdfVG9rZW46Ym94Y25Ed0k4VDlrU2xGVWZtbHJ4RTRvZmhoXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

**在Native项目的target中 build phases下添加lib库**

**Link Binary With Libraries 中添加lib库**

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=MjJiMTgyOTBlNWYxNjUzZDYxZjVlOTU0NTFkNzg3NjZfS21wRVJDZkJ6SkFpVW9OY2Vkblg4c2VVNnVGSDRZR1ZfVG9rZW46Ym94Y25Hb0V3UU9ocFhSUG5QNWNJTEZ2TlFlXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWFkMWIzNDE1NzkyMTJiOWU2MjRhYzc3NmMyZTllZGVfWHlOV0NLNmVETzJjM1NuMm9obmFBUUxVYUZlM3l2RkdfVG9rZW46Ym94Y25Cd0JSaFAxdURwelNvUE5YVGtTRTZmXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

profile文件中添加  添加 Capacitor-Vue-iOS项目中的podfile文件及工程目录

```Ruby
platform :ios, '12.0'

use_frameworks!

install! 'cocoapods', :disable_input_output_paths => true



workspace 'capacitorDemo'

project '/Users/dian1/Cool_App/CPWebBridgeView/CPWebBridgeView/ios/App/App.xcodeproj'

project '/Users/dian1/Dian_App/Capacitor/CPlive/CPlive.xcodeproj'





target 'CPlive' do

 # Comment the next line if you don't want to use dynamic frameworks

 use_frameworks!

 project '/Users/dian1/Dian_App/Capacitor/CPlive/CPlive.xcodeproj'

 # Pods for capacitorDemo



 target 'CPliveTests' do

  inherit! :search_paths

  # Pods for testing

 end

  

 target 'CPliveUITests' do

  # Pods for testing

 end



end





def capacitor_pods

 pod 'Capacitor', :path => '/Users/dian1/Documents/capacitor/capacitor-demo/CPWebView/node_modules/@capacitor/ios'

 pod 'CapacitorCordova', :path => '/Users/dian1/Documents/capacitor/capacitor-demo/CPWebView/node_modules/@capacitor/ios'



end



target 'App' do

 project '/Users/dian1/Cool_App/CPWebBridgeView/CPWebBridgeView/ios/App/App.xcodeproj'

 capacitor_pods

  

 target 'CPWebView' do

  capacitor_pods

 end

end
```

**Pod install 将Capacitor库导入** 

**编译CPWebView库 生成.a文件**

**webApp添加到native中 。**   **注意选择Create folder** 

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=NmRiZGVlZTRhMDg5NjdmNmUyZmRhNTNiNDc5NGQ2MGVfeDJlcVN3UHJCTVNGa0RyYmY3aXVtS2NEQkJweGVZWkpfVG9rZW46Ym94Y25LckpBTHY2bmtkT3JzWXNyVmZMVnBoXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

🎉🎉🎉      okk iOS的大功告成了~   🎉🎉🎉🎉 

之后再native中 就可以使用次库

![img](https://cyzj3pgpi6.feishu.cn/space/api/box/stream/download/asynccode/?code=MmI3YzQyNzQzNjQxZmNlNGJlOTIyYzkzNzRkMGRhY2Jfd0pkVk13Q012RHA5UGlDVlBzU1dHVU0zZFNkSlIwbFRfVG9rZW46Ym94Y25pajdSSHdkQUkwdVEzeU9NandJa1NjXzE2NTI2ODU4MzQ6MTY1MjY4OTQzNF9WNA)

### 融合Capacitor-Vue至Native --  Android

@贾利宁 





1. ## 插件创建

- npm init @capacitor/plugin

✔ What should be the npm package of your plugin?

 … navtive-api

✔ What directory should be used for your plugin?

 … NavtiveApi

✔ What should be the Package ID for your plugin?

… com.coolpi.hybridweb.navtiveapi

✔ What should be the class name for your plugin?

 … NavtiveApi

✔ What is the repository URL for your plugin?

 … https://gitlab.coolpi360.com/coolpi-org/frontend/web/navtiveapiplugin.git

✔ (optional) Who is the author of this plugin?

 … Dian

✔ What license should be used for your plugin?

 › MIT

✔ Enter a short description of plugin features.

 … coolpi的Capacitor-Vue客户端交互插件库

Installing dependencies. Please wait...

- 发布插件
  - npm run build
  - npm run verify
  - npm publish     (npm publish --access public)  私有包收费可能报错 使用公共的免费

1. ## 问题汇总

   1. 添加App工程后  无法使用 CPWebView 
   2. 添加App工程后  编译 CPWenViewLib库 报无法找到 Capacitor库问题
   3. 添加App工程后  pod install 失败

2. ## 

# 七、日常开发命yarn runyarn 

## npx

1. 编译当前版本

`npm run build`npx 

1. 使用 Capacitor CLI 的 `copy` 命令将 web 资源复制到原生项目

```
npx cap copy
```

1.  Capacitor CLI 的yrn `open` 命令在本地 IDE

```
npx cap open android
npx cap open ios
```

1. 运行对应App平台

```
npx cap run ios
```

1. 网页运行

```
npx run dev
```

## Ionic

```
ionic cap copy
ionic cap sync
```

参考：

1. [Ionic Portals - Ionic Portals](https://ionic.io/docs/portals)
2. [Introduction to Ionic | Ionic Documentation](https://ionicframework.com/docs)
3. [Architectural overview of Cordova platform - Apache Cordova](https://cordova.apache.org/docs/en/10.x/guide/overview/index.html)
4. [Capacitor by Ionic - Cross-platform apps with web technology](https://capacitorjs.com)
5. [移动跨平台开发框架解析与选型](https://segmentfault.com/a/1190000039122907)
6. [跨平台解决方案的技术分析 - TeqNG](https://www.teqng.com/2021/08/04/跨平台解决方案的技术分析/#zi_jian_xuan_ran_yin_qing_xuan_ran_fang_an)
7. [5万字全面总结编程那些年经历的跨平台开发工具框架演变历史](https://zhuanlan.zhihu.com/p/103409129)